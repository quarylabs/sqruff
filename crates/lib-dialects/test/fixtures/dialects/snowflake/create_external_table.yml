file:
- statement:
  - create_external_table_statement:
    - keyword: create
    - keyword: or
    - keyword: replace
    - keyword: external
    - keyword: table
    - table_reference:
      - naked_identifier: ext_table
    - keyword: with
    - keyword: location
    - comparison_operator:
      - raw_comparison_operator: =
    - stage_path: '@mystage/path1/'
    - keyword: file_format
    - comparison_operator:
      - raw_comparison_operator: =
    - file_format_segment:
      - bracketed:
        - start_bracket: (
        - json_file_format_type_parameters:
          - keyword: type
          - comparison_operator:
            - raw_comparison_operator: =
          - file_type: json
        - end_bracket: )
    - keyword: aws_sns_topic
    - comparison_operator:
      - raw_comparison_operator: =
    - quoted_literal: '''arn:aws:sns:us-west-2:001234567890:s3_mybucket'''
- statement_terminator: ;
- statement:
  - create_external_table_statement:
    - keyword: create
    - keyword: or
    - keyword: replace
    - keyword: external
    - keyword: table
    - table_reference:
      - quoted_identifier: '"_p08"'
    - keyword: with
    - keyword: location
    - comparison_operator:
      - raw_comparison_operator: =
    - stage_path: '@carpe_datastore_commercial/p08'
    - keyword: auto_refresh
    - comparison_operator:
      - raw_comparison_operator: =
    - boolean_literal: 'true'
    - keyword: file_format
    - comparison_operator:
      - raw_comparison_operator: =
    - file_format_segment:
      - bracketed:
        - start_bracket: (
        - parquet_file_format_type_parameters:
          - keyword: type
          - comparison_operator:
            - raw_comparison_operator: =
          - file_type: parquet
        - end_bracket: )
    - keyword: pattern
    - comparison_operator:
      - raw_comparison_operator: =
    - quoted_literal: '''.*[.]parquet.*'''
- statement_terminator: ;
- statement:
  - create_external_table_statement:
    - keyword: CREATE
    - keyword: EXTERNAL
    - keyword: TABLE
    - table_reference:
      - naked_identifier: EXTERNAL_TABLES
      - dot: .
      - naked_identifier: TRIPS
    - bracketed:
      - start_bracket: (
      - naked_identifier: tripduration
      - data_type:
        - data_type_identifier: integer
      - keyword: as
      - expression:
        - function:
          - function_name:
            - function_name_identifier: try_cast
          - function_contents:
            - bracketed:
              - start_bracket: (
              - expression:
                - cast_expression:
                  - column_reference:
                    - naked_identifier: VALUE
                  - semi_structured_expression:
                    - colon: ':'
                    - semi_structured_element: c1
                  - casting_operator: '::'
                  - data_type:
                    - data_type_identifier: varchar
              - keyword: as
              - data_type:
                - data_type_identifier: integer
              - end_bracket: )
      - keyword: not
      - keyword: 'null'
      - comma: ','
      - naked_identifier: starttime
      - data_type:
        - keyword: timestamp
      - keyword: as
      - expression:
        - function:
          - function_name:
            - function_name_identifier: try_cast
          - function_contents:
            - bracketed:
              - start_bracket: (
              - expression:
                - cast_expression:
                  - column_reference:
                    - naked_identifier: VALUE
                  - semi_structured_expression:
                    - colon: ':'
                    - semi_structured_element: c2
                  - casting_operator: '::'
                  - data_type:
                    - data_type_identifier: varchar
              - keyword: as
              - data_type:
                - keyword: timestamp
              - end_bracket: )
      - comma: ','
      - naked_identifier: stoptime
      - data_type:
        - keyword: timestamp
      - keyword: as
      - expression:
        - function:
          - function_name:
            - function_name_identifier: try_cast
          - function_contents:
            - bracketed:
              - start_bracket: (
              - expression:
                - cast_expression:
                  - column_reference:
                    - naked_identifier: VALUE
                  - semi_structured_expression:
                    - colon: ':'
                    - semi_structured_element: c3
                  - casting_operator: '::'
                  - data_type:
                    - data_type_identifier: varchar
              - keyword: as
              - data_type:
                - keyword: timestamp
              - end_bracket: )
      - comma: ','
      - naked_identifier: start_station_id
      - data_type:
        - data_type_identifier: integer
      - keyword: as
      - expression:
        - function:
          - function_name:
            - function_name_identifier: try_cast
          - function_contents:
            - bracketed:
              - start_bracket: (
              - expression:
                - cast_expression:
                  - column_reference:
                    - naked_identifier: VALUE
                  - semi_structured_expression:
                    - colon: ':'
                    - semi_structured_element: c4
                  - casting_operator: '::'
                  - data_type:
                    - data_type_identifier: varchar
              - keyword: as
              - data_type:
                - data_type_identifier: integer
              - end_bracket: )
      - keyword: 'null'
      - comma: ','
      - naked_identifier: start_station_name
      - data_type:
        - data_type_identifier: varchar
      - keyword: as
      - bracketed:
        - start_bracket: (
        - expression:
          - cast_expression:
            - column_reference:
              - naked_identifier: VALUE
            - semi_structured_expression:
              - colon: ':'
              - semi_structured_element: c5
            - casting_operator: '::'
            - data_type:
              - data_type_identifier: varchar
        - end_bracket: )
      - comma: ','
      - naked_identifier: start_station_latitude
      - data_type:
        - data_type_identifier: float
      - keyword: as
      - expression:
        - function:
          - function_name:
            - function_name_identifier: try_cast
          - function_contents:
            - bracketed:
              - start_bracket: (
              - expression:
                - cast_expression:
                  - column_reference:
                    - naked_identifier: VALUE
                  - semi_structured_expression:
                    - colon: ':'
                    - semi_structured_element: c6
                  - casting_operator: '::'
                  - data_type:
                    - data_type_identifier: varchar
              - keyword: as
              - data_type:
                - data_type_identifier: float
              - end_bracket: )
      - comma: ','
      - naked_identifier: start_station_longitude
      - data_type:
        - data_type_identifier: float
      - keyword: as
      - expression:
        - function:
          - function_name:
            - function_name_identifier: try_cast
          - function_contents:
            - bracketed:
              - start_bracket: (
              - expression:
                - cast_expression:
                  - column_reference:
                    - naked_identifier: VALUE
                  - semi_structured_expression:
                    - colon: ':'
                    - semi_structured_element: c7
                  - casting_operator: '::'
                  - data_type:
                    - data_type_identifier: varchar
              - keyword: as
              - data_type:
                - data_type_identifier: float
              - end_bracket: )
      - comma: ','
      - naked_identifier: end_station_id
      - data_type:
        - data_type_identifier: integer
      - keyword: as
      - expression:
        - function:
          - function_name:
            - function_name_identifier: try_cast
          - function_contents:
            - bracketed:
              - start_bracket: (
              - expression:
                - cast_expression:
                  - column_reference:
                    - naked_identifier: VALUE
                  - semi_structured_expression:
                    - colon: ':'
                    - semi_structured_element: c8
                  - casting_operator: '::'
                  - data_type:
                    - data_type_identifier: varchar
              - keyword: as
              - data_type:
                - data_type_identifier: integer
              - end_bracket: )
      - comma: ','
      - naked_identifier: end_station_name
      - data_type:
        - data_type_identifier: varchar
      - keyword: as
      - bracketed:
        - start_bracket: (
        - expression:
          - cast_expression:
            - column_reference:
              - naked_identifier: VALUE
            - semi_structured_expression:
              - colon: ':'
              - semi_structured_element: c9
            - casting_operator: '::'
            - data_type:
              - data_type_identifier: varchar
        - end_bracket: )
      - comma: ','
      - naked_identifier: end_station_latitude
      - data_type:
        - data_type_identifier: float
      - keyword: as
      - expression:
        - function:
          - function_name:
            - function_name_identifier: try_cast
          - function_contents:
            - bracketed:
              - start_bracket: (
              - expression:
                - cast_expression:
                  - column_reference:
                    - naked_identifier: VALUE
                  - semi_structured_expression:
                    - colon: ':'
                    - semi_structured_element: c10
                  - casting_operator: '::'
                  - data_type:
                    - data_type_identifier: varchar
              - keyword: as
              - data_type:
                - data_type_identifier: float
              - end_bracket: )
      - comma: ','
      - naked_identifier: end_station_longitude
      - data_type:
        - data_type_identifier: float
      - keyword: as
      - expression:
        - function:
          - function_name:
            - function_name_identifier: try_cast
          - function_contents:
            - bracketed:
              - start_bracket: (
              - expression:
                - cast_expression:
                  - column_reference:
                    - naked_identifier: VALUE
                  - semi_structured_expression:
                    - colon: ':'
                    - semi_structured_element: c11
                  - casting_operator: '::'
                  - data_type:
                    - data_type_identifier: varchar
              - keyword: as
              - data_type:
                - data_type_identifier: float
              - end_bracket: )
      - comma: ','
      - naked_identifier: bikeid
      - data_type:
        - data_type_identifier: integer
      - keyword: as
      - expression:
        - function:
          - function_name:
            - function_name_identifier: try_cast
          - function_contents:
            - bracketed:
              - start_bracket: (
              - expression:
                - cast_expression:
                  - column_reference:
                    - naked_identifier: VALUE
                  - semi_structured_expression:
                    - colon: ':'
                    - semi_structured_element: c12
                  - casting_operator: '::'
                  - data_type:
                    - data_type_identifier: varchar
              - keyword: as
              - data_type:
                - data_type_identifier: integer
              - end_bracket: )
      - comma: ','
      - naked_identifier: membership_type
      - data_type:
        - data_type_identifier: varchar
      - keyword: as
      - bracketed:
        - start_bracket: (
        - expression:
          - cast_expression:
            - column_reference:
              - naked_identifier: VALUE
            - semi_structured_expression:
              - colon: ':'
              - semi_structured_element: c13
            - casting_operator: '::'
            - data_type:
              - data_type_identifier: varchar
        - end_bracket: )
      - comma: ','
      - naked_identifier: usertype
      - data_type:
        - data_type_identifier: varchar
      - keyword: as
      - bracketed:
        - start_bracket: (
        - expression:
          - cast_expression:
            - column_reference:
              - naked_identifier: VALUE
            - semi_structured_expression:
              - colon: ':'
              - semi_structured_element: c14
            - casting_operator: '::'
            - data_type:
              - data_type_identifier: varchar
        - end_bracket: )
      - comma: ','
      - naked_identifier: birth_year
      - data_type:
        - data_type_identifier: integer
      - keyword: as
      - expression:
        - function:
          - function_name:
            - function_name_identifier: try_cast
          - function_contents:
            - bracketed:
              - start_bracket: (
              - expression:
                - cast_expression:
                  - column_reference:
                    - naked_identifier: VALUE
                  - semi_structured_expression:
                    - colon: ':'
                    - semi_structured_element: c15
                  - casting_operator: '::'
                  - data_type:
                    - data_type_identifier: varchar
              - keyword: as
              - data_type:
                - data_type_identifier: integer
              - end_bracket: )
      - comma: ','
      - naked_identifier: gender
      - data_type:
        - data_type_identifier: integer
      - keyword: as
      - expression:
        - function:
          - function_name:
            - function_name_identifier: try_cast
          - function_contents:
            - bracketed:
              - start_bracket: (
              - expression:
                - cast_expression:
                  - column_reference:
                    - naked_identifier: VALUE
                  - semi_structured_expression:
                    - colon: ':'
                    - semi_structured_element: c16
                  - casting_operator: '::'
                  - data_type:
                    - data_type_identifier: varchar
              - keyword: as
              - data_type:
                - data_type_identifier: integer
              - end_bracket: )
      - comma: ','
      - naked_identifier: year
      - data_type:
        - data_type_identifier: integer
      - keyword: as
      - bracketed:
        - start_bracket: (
        - expression:
          - cast_expression:
            - function:
              - function_name:
                - function_name_identifier: substr
              - function_contents:
                - bracketed:
                  - start_bracket: (
                  - expression:
                    - column_reference:
                      - naked_identifier: metadata$filename
                  - comma: ','
                  - expression:
                    - numeric_literal: '22'
                  - comma: ','
                  - expression:
                    - numeric_literal: '4'
                  - end_bracket: )
            - casting_operator: '::'
            - data_type:
              - data_type_identifier: integer
        - end_bracket: )
      - end_bracket: )
    - keyword: PARTITION
    - keyword: BY
    - bracketed:
      - start_bracket: (
      - naked_identifier: year
      - end_bracket: )
    - keyword: LOCATION
    - comparison_operator:
      - raw_comparison_operator: =
    - stage_path: '@external_tables.citibike_trips'
    - keyword: FILE_FORMAT
    - comparison_operator:
      - raw_comparison_operator: =
    - file_format_segment:
      - bracketed:
        - start_bracket: (
        - csv_file_format_type_parameters:
          - keyword: TYPE
          - comparison_operator:
            - raw_comparison_operator: =
          - file_type: '''CSV'''
          - keyword: FIELD_OPTIONALLY_ENCLOSED_BY
          - comparison_operator:
            - raw_comparison_operator: =
          - quoted_literal: '''"'''
        - end_bracket: )
- statement_terminator: ;
